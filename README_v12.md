# Avito API Client v12 - –ê–Ω–∞–ª–∏–∑ –∫—É–ø–ª–µ–Ω–Ω—ã—Ö —Ä–µ–∑—é–º–µ —Å —á–∞—Ç–∞–º–∏

## –ß—Ç–æ –Ω–æ–≤–æ–≥–æ –≤ v12

### üÜï –õ–∏—Å—Ç "–ö–æ–º—É –Ω–µ –ø–∏—Å–∞–ª–∏"
- **–ù–æ–≤—ã–π –ª–∏—Å—Ç "–ö–æ–º—É_–Ω–µ_–ø–∏—Å–∞–ª–∏"** —Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏ —É –∫–æ—Ç–æ—Ä—ã—Ö `chat_status = "–ù–µ –≤—ã—Å—ã–ª–∞–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è"`
- **–í–∫–ª—é—á–∞–µ—Ç –≤—Å–µ—Ö –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤** - –¥–∞–∂–µ —Ç–µ—Ö –∫—Ç–æ –≤ —Å—Ç–æ–ø-–ª–∏—Å—Ç–µ
- **–í—Å–µ –¥–∞–Ω–Ω—ã–µ –∫–∞–∫ –≤ –ª–∏—Å—Ç–µ "–î–ª—è_–∑–≤–æ–Ω–∫–æ–≤"** –ø–ª—é—Å —Å—Å—ã–ª–∫–∞ –Ω–∞ —á–∞—Ç
- **–ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏** –∫ —Ä–∞–±–æ—Ç–µ (–∞–∫—Ç–∏–≤–Ω–æ –∏—â—É—Ç -> –≥–æ—Ç–æ–≤—ã –∑–∞–≤—Ç—Ä–∞ -> –∏ —Ç.–¥.)
- **–ü—Ä—è–º—ã–µ —Å—Å—ã–ª–∫–∏ –Ω–∞ —á–∞—Ç—ã** –≤ —Ñ–æ—Ä–º–∞—Ç–µ `https://www.avito.ru/profile/messenger/{chat_id}`

### üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel —Ñ–∞–π–ª–∞ v12

```
üìÑ avito_paid_cvs_YYYYMMDD_HHMMSS.xlsx
‚îú‚îÄ‚îÄ üìã paid_cvs              # –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å JSON
‚îú‚îÄ‚îÄ üìã –î–ª—è_–∑–≤–æ–Ω–∫–æ–≤           # –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω—ã–µ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã  
‚îú‚îÄ‚îÄ üìã –Ω–∞_—Å–µ–≥–æ–¥–Ω—è            # –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å–µ–≥–æ–¥–Ω—è
‚îú‚îÄ‚îÄ üìã –ò—Å–∫–ª—é—á–µ–Ω–æ_–ø–æ_—Å—Ç–æ–ø–ª–∏—Å—Ç—É # –û—Ç—Ñ–∏–ª—å—Ç—Ä–æ–≤–∞–Ω–Ω—ã–µ
‚îú‚îÄ‚îÄ üÜï –ö–æ–º—É_–Ω–µ_–ø–∏—Å–∞–ª–∏        # –ö–∞–Ω–¥–∏–¥–∞—Ç—ã –±–µ–∑ –Ω–∞—à–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π + —Å—Å—ã–ª–∫–∏
‚îî‚îÄ‚îÄ üìã summary               # –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
```

## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
pip install playwright pandas openpyxl requests tzdata
python -m playwright install chromium

# –ó–∞–ø—É—Å–∫
python avito_paid_cvs_save_v_12.py --limit 500 --threads 12 --tz Europe/Moscow

# Headless —Ä–µ–∂–∏–º
python avito_paid_cvs_save_v_12.py --limit 1000 --headless
```

## –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### üéØ –ê–Ω–∞–ª–∏–∑ —Å—Ç–∞—Ç—É—Å–æ–≤ —á–∞—Ç–æ–≤
```python
class ChatStatus(Enum):
    READ_NO_REPLY = "–ü—Ä–æ—á–∏—Ç–∞–ª/–Ω–µ –æ—Ç–≤–µ—Ç–∏–ª"
    READ_REPLIED = "–ü—Ä–æ—á–∏—Ç–∞–ª/–û—Ç–≤–µ—Ç–∏–ª"  
    NO_MESSAGES_SENT = "–ù–µ –≤—ã—Å—ã–ª–∞–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è"  # ‚Üê –î–ª—è –ª–∏—Å—Ç–∞ "–ö–æ–º—É_–Ω–µ_–ø–∏—Å–∞–ª–∏"
    NOT_INTERESTED = "–ù–µ –∏–Ω—Ç–µ—Ä–µ—Å–Ω–æ"
    NO_CHAT = "–ß–∞—Ç –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç"
```

### üìã –õ–∏—Å—Ç "–ö–æ–º—É_–Ω–µ_–ø–∏—Å–∞–ª–∏"
- **–§–∏–ª—å—Ç—Ä**: `chat_status == "–ù–µ –≤—ã—Å—ã–ª–∞–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è"`
- **–í–∫–ª—é—á–∞–µ—Ç**: –ö–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏–∑ —Å—Ç–æ–ø-–ª–∏—Å—Ç–∞ —Ç–æ–∂–µ
- **–°–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞**: –ü–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Ä–∞–±–æ—Ç–µ
- **–°—Ç–æ–ª–±—Ü—ã**: –í—Å–µ –∫–∞–∫ –≤ "–î–ª—è_–∑–≤–æ–Ω–∫–æ–≤" + `chat_url`

```python
def create_not_contacted_dataframe(df: pd.DataFrame) -> pd.DataFrame:
    """–°–æ–∑–¥–∞–µ—Ç DataFrame —Å –∫–∞–Ω–¥–∏–¥–∞—Ç–∞–º–∏, –∫–æ–º—É –Ω–µ –ø–∏—Å–∞–ª–∏"""
    not_contacted = df[df['chat_status'] == ChatStatus.NO_MESSAGES_SENT.value].copy()
    
    # –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ —Å—Ç–∞—Ç—É—Å—É –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏
    status_priority = {
        "–ê–∫—Ç–∏–≤–Ω–æ –∏—â—É —Ä–∞–±–æ—Ç—É": 1,
        "–ì–æ—Ç–æ–≤ –≤—ã–π—Ç–∏ –∑–∞–≤—Ç—Ä–∞": 2,
        "–ì–æ—Ç–æ–≤ –≤—ã–π—Ç–∏ –≤ —Ç–µ—á–µ–Ω–∏–µ 2-—Ö –Ω–µ–¥–µ–ª—å": 3,
        # ...
    }
    
    return not_contacted.sort_values(['status_priority', 'update_date'])
```

### üîó –°—Å—ã–ª–∫–∏ –Ω–∞ —á–∞—Ç—ã
–§–æ—Ä–º–∞—Ç: `https://www.avito.ru/profile/messenger/{chat_id}`

```python
result.update({
    'chat_url': f"https://www.avito.ru/profile/messenger/{chat_id}" if chat_id else ""
})
```

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ v12

### üîÑ –ü—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏
1. **–ó–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–æ–ø-–ª–∏—Å—Ç–∞** –∏–∑ Excel —Ñ–∞–π–ª–æ–≤
2. **–ü–æ–ª—É—á–µ–Ω–∏–µ API —Ç–æ–∫–µ–Ω–∞** OAuth2 client_credentials
3. **–ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö —á–∞—Ç–æ–≤** —Å –æ–±—Ö–æ–¥–æ–º offset=1000 limit
4. **–°–∫—Ä–∞–ø–∏–Ω–≥ —Ä–µ–∑—é–º–µ** —á–µ—Ä–µ–∑ Playwright
5. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞** —Å API + –∞–Ω–∞–ª–∏–∑ —á–∞—Ç–æ–≤
6. **–°–æ–∑–¥–∞–Ω–∏–µ 6 –ª–∏—Å—Ç–æ–≤** –≤–∫–ª—é—á–∞—è –Ω–æ–≤—ã–π "–ö–æ–º—É_–Ω–µ_–ø–∏—Å–∞–ª–∏"

### üßµ –ú–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ—Å—Ç—å
```python
def process_resumes_parallel(resume_list, token, chats_by_resume, max_workers=8):
    with ThreadPoolExecutor(max_workers=max_workers) as executor:
        # –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ API + —á–∞—Ç—ã
```

### üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —á–∞—Ç–æ–≤
```python
stats = {
    "v2_main_loaded": 800,      # –û—Å–Ω–æ–≤–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ v2 API
    "v2_unread_loaded": 200,    # –ù–µ–ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—ã–µ —á–∞—Ç—ã  
    "v1_fallback_loaded": 50,   # Fallback —á–µ—Ä–µ–∑ v1 API
    "chat_types_loaded": 50,    # –ü–æ —Ç–∏–ø–∞–º —á–∞—Ç–æ–≤
    "unique_chats": 1100        # –í—Å–µ–≥–æ —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö
}
```

## –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø–æ –≤–µ—Ä—Å–∏—è–º

### v12 ‚Üê v11
- ‚úÖ –ù–æ–≤—ã–π –ª–∏—Å—Ç "–ö–æ–º—É_–Ω–µ_–ø–∏—Å–∞–ª–∏" —Å –ø—Ä—è–º—ã–º–∏ —Å—Å—ã–ª–∫–∞–º–∏ –Ω–∞ —á–∞—Ç—ã
- ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏–∑ —Å—Ç–æ–ø-–ª–∏—Å—Ç–∞ –≤ –∞–Ω–∞–ª–∏–∑ –Ω–µ–ø—Ä–æ–∫–æ–Ω—Ç–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö
- ‚úÖ –ü—Ä–∏–æ—Ä–∏—Ç–∏–∑–∞—Ü–∏—è –ø–æ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –∫ —Ä–∞–±–æ—Ç–µ

### v11 ‚Üê v10  
- ‚úÖ –¢–∏–ø–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å—Ç–∞—Ç—É—Å—ã —á–∞—Ç–æ–≤ (`ChatStatus`, `MessageDirection`)
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –ø–æ—Å–ª–µ–¥–Ω–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π –∏ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –∑–∞–∏–Ω—Ç–µ—Ä–µ—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏
- ‚úÖ –û–±—Ö–æ–¥ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è offset=1000 –¥–ª—è —á–∞—Ç–æ–≤

### v10 ‚Üê v9
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ API (—É—Å–∫–æ—Ä–µ–Ω–∏–µ –≤ 5-8 —Ä–∞–∑)
- ‚úÖ –ì–µ–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∏ –≤—Ä–µ–º–µ–Ω–Ω—ã–µ –∑–æ–Ω—ã
- ‚úÖ –õ–∏—Å—Ç "–Ω–∞_—Å–µ–≥–æ–¥–Ω—è" —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π –ø–æ –≤—Ä–µ–º–µ–Ω–∏

## API Endpoints

```
üåê Avito API Base: https://api.avito.ru

üìä –†–µ–∑—é–º–µ:
  GET /job/v2/resumes/{id}           # –î–∞–Ω–Ω—ã–µ —Ä–µ–∑—é–º–µ
  GET /job/v1/resumes/{id}/contacts  # –ö–æ–Ω—Ç–∞–∫—Ç–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

üí¨ –ß–∞—Ç—ã:  
  GET /messenger/v2/accounts/{user_id}/chats              # –°–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤
  GET /messenger/v1/accounts/{user_id}/chats/{id}/messages # –°–æ–æ–±—â–µ–Ω–∏—è

üîê –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:
  POST /token  # OAuth2 client_credentials
```

## –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –ë–∞–∑–æ–≤—ã–π –∑–∞–ø—É—Å–∫
```bash
python avito_paid_cvs_save_v_12.py --limit 100
```

### –ü—Ä–æ–¥–∞–∫—à–Ω —Ä–µ–∂–∏–º
```bash
python avito_paid_cvs_save_v_12.py \
  --limit 1000 \
  --threads 16 \
  --tz Europe/Moscow \
  --headless
```

### –ê–Ω–∞–ª–∏–∑ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
```python
import pandas as pd

# –ß–∏—Ç–∞–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
df = pd.read_excel('avito_paid_cvs_20241221_120000.xlsx', sheet_name='–ö–æ–º—É_–Ω–µ_–ø–∏—Å–∞–ª–∏')

# –¢–æ–ø –∫–∞–Ω–¥–∏–¥–∞—Ç—ã –¥–ª—è –ø–µ—Ä–≤–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞
priority_candidates = df[df['status'] == '–ê–∫—Ç–∏–≤–Ω–æ –∏—â—É —Ä–∞–±–æ—Ç—É'].head(10)

# –ü–µ—Ä–µ—Ö–æ–¥–∏–º –ø–æ —Å—Å—ã–ª–∫–∞–º –Ω–∞ —á–∞—Ç—ã
for _, candidate in priority_candidates.iterrows():
    print(f"{candidate['name']}: {candidate['chat_url']}")
```

## Troubleshooting

### üîß –†–∞—Å–ø—Ä–æ—Å—Ç—Ä–∞–Ω–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

**1. –û—à–∏–±–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ API**
```python
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Å—Ä–µ–¥—ã
CLIENT_ID = "Dm4ruLMEr9MFsV72dN95"  
CLIENT_SECRET = "f73lNoAJLzuqwoGtVaMnByhQfSlwcyIN_m7wyOeT"
```

**2. –ü—É—Å—Ç–æ–π –ª–∏—Å—Ç "–ö–æ–º—É_–Ω–µ_–ø–∏—Å–∞–ª–∏"**  
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –µ—Å—Ç—å —á–∞—Ç—ã —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "–ù–µ –≤—ã—Å—ã–ª–∞–ª–∏ —Å–æ–æ–±—â–µ–Ω–∏—è"
- –£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ –∑–∞–≥—Ä—É–∑–∫–∞ —á–∞—Ç–æ–≤ –ø—Ä–æ—à–ª–∞ —É—Å–ø–µ—à–Ω–æ
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —á–∞—Ç–æ–≤

**3. –ú–µ–¥–ª–µ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞**
```bash
# –£–≤–µ–ª–∏—á—å—Ç–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ—Ç–æ–∫–æ–≤
python avito_paid_cvs_save_v_12.py --threads 16
```

**4. –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ offset=1000**
- v12 –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ö–æ–¥–∏—Ç —ç—Ç–æ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ –∑–∞–≥—Ä—É–∑–∫–∏
- –õ–æ–≥–∏—Ä—É–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –æ–±—Ö–æ–¥–∞

### üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞
- –í–µ—Ä—Å–∏—è: **v12** (–¥–µ–∫–∞–±—Ä—å 2024)
- –ê–≤—Ç–æ—Ä: GitHub Copilot
- –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π: [ALALA](https://github.com/JOPIUS/ALALA)